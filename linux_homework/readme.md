BASH SCRIPTS

1 Общее количетво запросов
* Скрипт

   ` echo 'Общее количество запросов'> tmp/result.txt | cat access.log | wc -l>> tmp/result.txt`
* Описание работы
    * Считывается access.log, с помощью утитлиты cat
    * C опцией -l считает количество строк в файле
    * Результат записывается в файл task1.txt
* Результат task1.txt

2  Общее количество запросов по типу, например: GET - 20, POST - 10 и т.д.
* Скрипт

    `echo 'Общее количество запросов по типу'> tmp/task2.txt | cat access.log| awk '{print $6}'|sort|uniq -c| sort -rn| awk '{print $2, $1}'>> tmp/task2.txt`
* Описание работы
    * Считывается access.log с помощью утитлиты cat
    * awk '{print $6}' - вывод 6 колонки
    * Сортировка с помощью sort
    * uniq -c - выводит уникальные строки и сколько раз они встречаются
    * Сортировка по частоте вхождения строки с помощью sort -rn
    * Меняется порядок столбцов с помощью awk
* Результат task2.txt

3 Топ 10 самых частых запросов
* Скрипт 
    
    `echo 'Топ 10 самых частых запросов'> tmp/task3.txt | cat access.log| awk '{print $7}'|sort|uniq -c|sort -rn|head -n10| awk '{print $2, $1}'>>tmp/task3.txt`
* Описание работы
    * Считывается access.log с помощью утитлиты cat
    * awk '{print $7}' - вывод колонки, содержащей url
    * Сортировка с помощью sort
    * uniq -c - выводит уникальные строки и их количество
    * Сортировка по частоте вхождения строки с помощью sort -rn
    * Вывод первые 10 значений с помощью head -n10
    * Меняется порядок столбцов с помощью awk
* Результат task3.txt

4 Топ 5 самых больших по размеру запросов, которые завершились клиентской (4ХХ) ошибкой
* Скрипт

    `echo 'Топ 5 самых больших по размеру запросов, которые завершились клиентской (4ХХ) ошибкой'> tmp/task4.txt | cat access.log| awk '{print $7, $9, $10, $1}'|grep ' 4.. '|sort -rn -k3|head -n5>>tmp/task4.txt`
* Описание работы
    * Считывается access.log с помощью утитлиты cat
    * awk '{print $7, $9, $10, $1}' - вывод колонок, содержащих url, статус кода, размер запроса и ip адрес
    * Отбираем строки со статусом кода, который начинается на 4 (grep ' 4.. ')
    * Сортировка по убыванию размера
    * Вывод первые 5 значений с помощью head -n5
* Результат task4.txt

5 Топ 5 пользователей по количеству запросов, которые завершились серверной (5ХХ) ошибкой
* Скрипт

    `echo 'Топ 5 пользователей по количеству запросов, которые завершились серверной (5ХХ) ошибкой' > tmp/task5.txt | cat access.log | awk '$9 ~ /^5[0-9][0-9]/ {print $1}'| uniq -c | sort -nr | head -n5 | awk '{print $2, $1}'>> tmp/task5.txt`
* Описание работы
    * Считывается access.log с помощью утитлиты cat
    * awk '$9 ~ /^5[0-9][0-9]/ {print $1}'  - считываются колонки с ip-фдресом, статус код запроса которых начинается на 5
    * uniq -c - выводит уникальные строки и их количество
    * Сортировка по убыванию с помощью sort -rn
    * Вывод первые 5 значений с помощью head -n5
    * Меняется порядок столбцов с помощью awk
* Результат task5.txt
